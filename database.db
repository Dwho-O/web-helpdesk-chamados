create database helpdesk;
use helpdesk;

create table usuario(
    idUsuario int primary key auto_increment not null,
    nome varchar(100) not null,
    foto varchar(255) not null
);

create table usuario_login(
    idUsuarioLogin int primary key auto_increment not null,
    email varchar(50) not null,
    senha varchar(25) not null
);

create table usuario_cargo(
    idUsuarioCargo int primary key auto_increment not null,
    cargo enum('administrador','suporte','usuario') not null
);

create table usuario_area(
    idUsuarioArea int primary key auto_increment not null,
    area enum('comercial','financeiro','rh','escritorio') not null
);

create table usuario_status(
    idUsuarioStatus int primary key auto_increment not null,
    status enum ('ativo','desativado','ferias') not null
);

create table chamado(
    idChamado int primary key auto_increment not null,
    titulo varchar(35) not null,
    data datetime not null,
    mensagem varchar(255) not null,
    evidencia varchar(255) not null
);

create table chamado_comentario(
    idChamadoComentario int primary key auto_increment not null,
    comentario varchar(255) not null
);

create table chamado_status(
    idChamadoStatus int primary key auto_increment not null,
    status_chamado enum('pendente','solucionado') not null
);

ALTER TABLE usuario
ADD CONSTRAINT FK_usuarioLogin
FOREIGN KEY (idUsuario) REFERENCES usuario_login(idUsuarioLogin);

ALTER TABLE usuario
ADD CONSTRAINT FK_usuarioCargo
FOREIGN KEY (idUsuario) REFERENCES usuario_cargo(idUsuarioCargo); 

ALTER TABLE usuario
ADD CONSTRAINT FK_usuarioArea
FOREIGN KEY (idUsuario) REFERENCES usuario_area(idUsuarioArea);

ALTER TABLE usuario
ADD CONSTRAINT FK_usuarioStatus
FOREIGN KEY (idUsuario) REFERENCES usuario_status(idUsuarioStatus); 

ALTER TABLE usuario
ADD CONSTRAINT FK_usuarioChamado
FOREIGN KEY (idUsuario) REFERENCES chamado(idChamado);

ALTER TABLE chamado
ADD CONSTRAINT FK_usuarioChamadoStatus
FOREIGN KEY (idChamado) REFERENCES chamado_status(idChamadoStatus);

ALTER TABLE chamado
ADD CONSTRAINT FK_usuarioChamadoComentario
FOREIGN KEY (idChamado) REFERENCES chamado_comentario(idChamadoComentario);


INSERT INTO `chamado_comentario` (`idChamadoComentario`, `comentario`) VALUES (NULL, 'isso é um comentário do chamado');
INSERT INTO `chamado_status` (`idChamadoStatus`, `status_chamado`) VALUES (NULL, 'pendente');
INSERT INTO `chamado` (`idChamado`, `titulo`, `data`, `mensagem`, `evidencia`) VALUES (NULL, 'meu computador está com problemas', '2022-08-04 21:39:57', 'a tela do computador está preta', 'https://www.w3schools.com/howto/img_avatar.png');

INSERT INTO `usuario_area` (`idUsuarioArea`, `area`) VALUES (NULL, 'comercial');

INSERT INTO `usuario_cargo` (`idUsuarioCargo`, `cargo`) VALUES (NULL, 'administrador');

INSERT INTO `usuario_login` (`idUsuarioLogin`, `email`, `senha`) VALUES (NULL, 'joao@gmail.com', 'fowojdo');

INSERT INTO `usuario_status` (`idUsuarioStatus`, `status`) VALUES (NULL, 'ativo');
INSERT INTO `usuario` (`idUsuario`, `nome`, `foto`) VALUES (NULL, 'João Paulo', 'https://www.w3schools.com/howto/img_avatar.png');